%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% CONFIGURA??ES DE CAPA %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{titlepage}
	
	% CAPA PRINCIPAL
	\begin{center}
		\Huge{UNIVERSIDADE DE SÃO PAULO}\\
		\vspace{0.02\textheight}
		\huge{ESCOLA DE ENGENHARIA DE SÃO CARLOS}\\
		\vspace{0.01\textheight}
		\huge{DEPARTAMENTO DE ENGENHARIA ELÉTRICA E DE COMPUTAÇÃO}\\
		\vspace{0.2\textheight}
		\huge{\textbf{Sistema Automatizado de Produção de Cerveja, Monitorado e Controlado Remotamente}}
		\vspace{0.2\textheight}
	\end{center}
		
		\large
		{
			\begin{flushleft}
			\Large{ \textbf{Autor}: \hspace{1.45cm} Leonardo Graboski Veiga }\\
			\Large{ \textbf{Orientador}: \hspace{0.3cm} Prof. Dr. Evandro Luis Linhari Rodrigues }\\
			\end{flushleft}
	
			\begin{center}
				\vspace{0.09\textheight}
				\Large{São Carlos}\\
				\Large{2015}
			\end{center}
		}
	
\end{titlepage}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% INSER??O P?GINA EM BRANCO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FOLHA DE ROSTO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\vspace{0.01\textheight} 
	\begin{center}
	\vspace{-0.06\textheight}
	%\thispagestyle{empty}
		\Large{\textbf{Leonardo Graboski Veiga}}\\
		\vspace{0.15\textheight}
		\Huge{\textbf{Sistema Automatizado de Produção de Cerveja, Monitorado e Controlado Remotamente}} 
		\vspace{0.08\textheight}
	\end{center}
		
		\large
		{
			\begin{flushright}
			\Large{Trabalho de Conclusão de Curso apresentado} \hspace{1cm}\\
			\Large{à Escola de Engenharia de São Carlos, da}\\
			\Large{Universidade de São Paulo}\\
			\vspace{0.05\textheight}
			\Large{Curso de Engenharia Elétrica}\\
			\vspace{0.05\textheight}
			\Large{ORIENTADOR: Prof. Dr. Evandro Luis Linhari Rodrigues}\\
			\end{flushright}
	
			\begin{center}
				\vspace{0.15\textheight}
				\Large{São Carlos}\\
				\Large{2015}
			\end{center}
		}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FICHA CATALOGRAFICA % % % % % % % % % % % % % % % % % % %
\newpage

Página com a ficha catalográfica (em página par).

%ficha catalografica no verso
%\includepdf{./Resources/ficha_catalografica.pdf}

% % % % % % % % % % % % % % % % % % % % % % % % Folha de aprovação % % % % % % % % % % % % % % % % % % %
\newpage

página com a folha de aprovação (página ímpar). \cleardoublepage

\begin{comment}
\begin{figure}[H]
	\centering
	\includegraphics[scale=0.3]{./Resources/aprovacao.jpg}
	\caption{Fluxo de comunicação entre os principais componentes.}
	\label{Aprovacao}
\end{figure}
\cleardoublepage
\end{comment}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% DEDICAT?RIA %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\
\vspace{0.11\textheight} 
\begin{center}
\textbf{\Huge{Dedicatória}}
\end{center}
\vspace{0.05\textheight}	
		
Dedico este trabalho aos meus pais.
		
\begin{flushright}
Leonardo Graboski Veiga.
\end{flushright}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% INSER??O P?GINA EM BRANCO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% AGRADECIMENTOS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\
\vspace{0.11\textheight} 

\begin{center}
\textbf{\Huge{Agradecimentos}}
\end{center}

\vspace{0.05\textheight}
			
Tenho convicção de que quem somos pode ser sintetizado pela soma das interações sociais que acumulamos com o passar dos anos. É por isso que agradeço a todos que passaram por minha vida --- cada um de vocês é parte daquilo que hoje sou. Não obstante, alguns nomes em específico devem ser lembrados.

Agradeço à minha família pelo suporte incondicional: aos meus genitores Dirce Graboski e Gustavo Veiga, pela vida e por tudo aquilo que se sucedeu desde então; à minha avó Sofia Karachinski e o meu avô Victor Graboski, que me ensinaram que as virtudes e a inteligência de um ser humano vão muito além do estudo; aos meus padrinhos Luis Fernando Busnardo e Cinderela Busnardo, com os quais me diverti e aprendi um bocado; às minhas tias Inez Graboski e Glaci Edwiges Graboski, que foram minhas segundas mães durante a maior parte da minha vida; aos meus primos e primas André Luiz Graboski, Felippe Busnardo, Ana Paula Busnardo e Maria Fernanda Busnardo e; à esposa do meu pai, Elisabete Veiga.

Agradeço aos meus amigos de Curitiba pelas inúmeras situações que compartilhamos: Albert Faria, Pedro Henrique Bertolin, Douglas Auchewski, Eduardo Henrique Fasolin, Isabela Deolindo, Lucas Lupatini, Pamella Prohmann, Massimo Karly, Moacir Costa Filho, Lucas Vieira e Paulo Jacques Filho, dentre vários outros não menos importantes. Desde os tempos do Santa Maria e, posteriormente da UTFPR, até os dias de hoje, nunca aceitaram ver senão alegria em meus olhos, motivando o meu desenvolvimento técnico e pessoal.

Agradeços aos meus amigos de São Carlos pela caminhada que fizemos juntos ao longo destes anos de faculdade: Rafael Hellman, com quem dividi não somente moradia, mas também as dificuldades da engenharia e muitos momentos de festa entre uma prova e outra; Rafael Oishi, Vitor Martins e Gabriel Moreira, da Rep Hot Chili Peppers, minha segunda casa sancarlense; Renato Nunes Moraes e Renata de Camilo, pelo duradouro companheirismo e; a todos os outros amigos e colegas de classe que compartilharam experiência e conhecimento em prol de atingir um objetivo coletivo almejado por todos, chamado graduação.

Agradeço aos meus professores: em especial ao meu professor orientador Prof. Dr. Evandro Luis Linhari Rodrigues, que me incentivou a sempre buscar o melhor e me apresentou ao incrível mundo do Linux embarcado.

Não menos importantes, agradeço àqueles que contribuíram para o resultado final que é este trabalho de conclusão de curso, dentre os quais o Rui Bertho, responsável pela oficina mecânica do departamento. E a todos os outros que porventura eu tenha esquecido por um lapso de memória, mas não por falta de merecimento.


\begin{flushright}
Leonardo Graboski Veiga.
\end{flushright}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% INSER??O P?GINA EM BRANCO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% EPÍGRAFE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\
\vspace{0.76\textheight} 

\begin{flushright}
\textit{"O sucesso é ir de fracasso em fracasso}

\textit{sem perder o entusiasmo."}

Winston Churchill
\end{flushright}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% INSER??O P?GINA EM BRANCO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% RESUMO - PORTUGUES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\
\vspace{0.11\textheight} 

\begin{center}
\textbf{\Huge{Resumo}}
\end{center}

\vspace{0.05\textheight}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LONG VERSION %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
			
%Este trabalho consistiu na implementação de um sistema elétrico automatizado de produção de cerveja, baseado na plataforma de Linux embarcado BeagleBone Black. Inicialmente foi realizado o estudo do processo produtivo da cerveja, com foco no cozimento do mosto, lavagem dos grãos, fervura e resfriamento do mosto. Para o cozimento do mosto, quatro métodos principais foram encontrados na bibliografia, sendo o cozimento por rampas e degraus de temperatura o escolhido para implementação, em função tanto da flexibilidade que este proporciona na brassagem, quanto da economia de energia quando comparado a outros métodos. Para a lavagem dos grãos, foi escolhida uma configuração de equipamento que permitisse a aplicação desta técnica com a restrição de que o mosto inevitavelmente se misturasse á água da lavagem. Já para a fervura, foram estudados os lúpulos e suas características e empregos, o que permitiu o projeto de uma estrutura para a adição automática destes ingredientes controlada por um servo-motor de aeromodelismo. No resfriamento do mosto foi empregado um trocador de calor de contra-fluxo.

%A plataforma de Linux embarcado BeagleBone Black foi escolhida para a implementação do controle do sistema, interface web de usuário e comunicação com a internet, em função do emprego do Linux embarcado e dos seus recursos de hardware: possibilidade de até 65 pinos de GPIO, 8 PWMs, 7 entradas analógicas e 1 unidade programável de tempo-real. Com relação à programação do servidor, foi empregada a linguagem de programação Javascript, interpretada pelo ambiente Node.js; seu uso permitiu o acesso a recursos de hardware por meio do módulo Octalbonescript e a implementação de um servidor web minimalista a partir do módulo Express.js. Ambos os módulos, combinados à programação em Node.js de um algoritmo de controle automático da brassagem, foram a ponte entre usuário ou operador do sistema e a sua estrutura mecânica. Para isto, também foi importante o desenvolvimento de uma interface gráfica de usuário intuitiva e funcional, que permitiu a adição, edição e gerenciamento de receitas de cerveja, o controle manual do sistema mecânico e o início e supervisão da produção automatizada. Em nível de hardware, a interface entre o sistema embarcado e a parte mecânica foi permitida com o desenvolvimento de um circuito de acionamentos de potência que empregou optoacopladores, transistores MOSFET e relés de estado sólido.

%No controle do cozimento dos grãos e do aquecimento da água de lavagem, foram empregados sensores digitais DS18B20 para monitoramento e realimentação do sistema de controle de temperatura. O sistema escolhido foi um controle liga-desliga com quatro níveis de potência de saída (0\%, 33\%, 66\% e 100\%) e janela de tempo de 1 segundo de duração. Os elementos atuadores foram dois resistores específicos para esta função, um para cada panela, cuja potência máxima projetada foi de 2200W em 110Vac.

%Como resultados, foram realizados testes da interface gráfica de usuário em um computador com tela de resolução 1766 x 768 pixels e em um smartphone cuja resolução de tela é de 320 x 480 pixels, e para os quais foi concluído que, embora a interface seja funcional para ambos os casos, o design somente mantém sua integridade na tela do computador. A comprovação do algoritmo de automação foi realizada por meio da interface de usuário, empregando uma receita específicamente desenvolvida para este propósito e com o auxílio de um script em Python para simulação do sensor de temperatura. O funcionamento do circuito de acionamentos de potência foi comprovado visualmente em bancada, com o emprego de LEDs ligados às saídas e controle manual do sistema a partir da interface web de usuário, com exceção do acionamento do servo-motor da estrutura de adição de lúpulos; para este, o uso de um osciloscópio foi imprescindível, em decorrência da necessidade de observar a integridade do sinal de controle PWM. O funcionamento da estrutura mecânica foi o último teste realizado, somente com água. Isto também validou o funcionamento dos circuitos de acionamento de potência, do algoritmo de controle automático da brassagem e da interface gráfica de usuário. Em síntese, o teste de integração do sistema possibilitou a validação de todas as partes do projeto operando em conjunto.

%Como conclusão, foi observado que, embora o sistema desenvolvido cumpra às especificações do projeto, possibilitando o controle automático e supervisão de uma brassagem pela internet, diversos fatores não comtemplados neste projeto são essenciais para transformá-lo efetivamente em um produto. Dentre eles, estão a ergonomia, a facilidade de manutenção, a adição de sistemas supervisores de redundância, maior preocupação com segurança e eficiência energética, além da adequação da parte mecânica às normas sanitárias porventura exigidas pelas suas respectivas agências reguladoras. Apesar dos pontos de melhorias apontados para trabalhos futuros e, em função dos recursos disponíveis para a elaboração e execução do projeto, este foi considerado um sucesso dados os resultados apresentados.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Short version %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Este trabalho consistiu na implementação de um sistema elétrico automatizado de produção de cerveja, baseado na plataforma de Linux embarcado BeagleBone Black. Inicialmente foi realizado o estudo do processo produtivo da cerveja, com foco no cozimento do mosto, lavagem dos grãos, fervura e resfriamento do mosto. A BeagleBone Black foi escolhida para a implementação do controle do sistema, interface web de usuário e comunicação com a internet, em função do emprego do Linux embarcado e dos seus recursos de hardware: até 65 pinos de GPIO, 8 PWMs, 7 entradas analógicas e 1 unidade programável de tempo-real. Com relação à programação do servidor, foi empregada a linguagem de programação Javascript, interpretada pelo ambiente Node.js. Para a interface entre o sistema embarcado e a parte mecânica foi desenvolvido um circuito de acionamentos de potência com optoacopladores, transistores MOSFET e relés de estado sólido. Foram empregados sensores digitais DS18B20 para monitoramento e realimentação do sistema de controle de temperatura: um controle liga-desliga com quatro níveis de potência de saída (0\%, 33\%, 66\% e 100\%) e janela de tempo de 1 segundo de duração. Os elementos atuadores foram dois resistores específicos para esta função, cuja potência máxima projetada para cada um foi de 2200W em 110Vac.

Como resultados, foram realizados testes da interface gráfica de usuário em um computador e em um smartphone, para os quais foi concluído que, embora a interface seja funcional para ambos os casos, o design somente mantém sua integridade na tela do computador. A comprovação do algoritmo de automação foi realizada por meio da interface de usuário, empregando uma receita de cerveja desenvolvida para propósito de simulação, e de um script em Python, simulando o sensor de temperatura. O funcionamento do circuito de acionamentos de potência foi comprovado visualmente em bancada, com o emprego de LEDs ligados às saídas e controle manual do sistema, com exceção do acionamento do servo-motor, para o qual foi usado um osciloscópio, no intuito de observar o sinal de controle PWM. O funcionamento da estrutura mecânica foi o último teste realizado --- um teste de integração, somente com água, no qual observou-se que este é capaz de cumprir os requisitos para produção de cerveja. Em síntese, este teste possibilitou a validação de todas as partes do projeto operando em conjunto.

Pode-se concluir que, embora o sistema desenvolvido cumpra às especificações do projeto, possibilitando o controle automático e supervisão de uma brassagem pela internet, diversos fatores não comtemplados neste projeto são essenciais para transformá-lo efetivamente em um produto. Dentre eles a ergonomia, a facilidade de manutenção, a adição de sistemas supervisores de redundância, maior preocupação com segurança e eficiência energética, além da adequação da parte mecânica às normas sanitárias porventura exigidas pelas suas respectivas agências reguladoras. Apesar dos pontos de melhorias apontados para trabalhos futuros e, em função dos recursos disponíveis para a elaboração e execução do projeto, este foi considerado um sucesso dados os resultados apresentados.

\vspace{0.05\textheight}
	
Palavras-Chave: BeagleBone, Black, Node.js, controlador, brassagem, cerveja, automatizado, SBC, web, internet, remoto.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% INSER??O P?GINA EM BRANCO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% RESUMO - INGLÊS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\
\vspace{0.11\textheight} 

\begin{center}
\textbf{\Huge{Abstract}}
\end{center}

\vspace{0.05\textheight}	
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Short version %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
This work had consisted in the implementation of an automated electric brewing system, based on the BeagleBone Black embedded Linux platform. First, a study of the beer brewing process was made, focused in the mash, sparging, boil and chilling of the wort. The BeagleBone Black was chosen to implement the control system, web user interface and internet communication, due to the embedded Linux and its hardware resources: up to 65 GPIO pins, 8 PWMs, 7 analog inputs, 1 programmable realtime unit. For the server-side programming, the Javascript language was chosen, interpreted by the Node.js environment. For the interface between the embedded system and the mechanical structure, a power drive circuit was designed, by using optocouplers, MOSFET transistors and solid-state relays. Digital sensors DS18B20 were employed as monitoring and feedback devices to the temperature control system: an on-off control with four output power levels (0\%, 33\%, 66\% e 100\%) and a time window of 1 second. The actuators were two specific resistors, to which the maximum power was 2200W at 110Vac.

As results, the graphical user interface was tested both on a computer and a smartphone screen, and it was concluded that although the interface is functional for both scenarios, the design only keeps its integrity on the computer screen. The automation algorith validation was tested by the user interface, while running a beer recipe tailored for simulation purposes and a Pyhton script to simulate the temperature sensor. The power drive circuit bench test was approved by means of a visual inspection, with LEDs coupled to the outputs and manual control of the system; altough for the servo-motor an oscilloscope was used to observe the PWM control signal. The mechanical structure operation was the last test --- an integration test, with water only, in which it was observed that the system is capable of fulfill the requisites to brew beer. In synthesis, this test allowed for the validation of all the project parts operating together.

It can be concluded that, even though the developed system comply to the project specification by allowing the automatic brewing online control and supervision via web, there are still many factors not contemplated in this project that are essential to transform it into a product. Among them there are ergonomics, easiness of maintenance, redundancy supervisor systems, higher concerns regarding safety and energy efficiency, and the mechanincal system compliance to health standards possibly required by its respective regulatory agencies. Altough there are many improvements pointed out to future works and, because of the restricted resources available for the project design and execution, it was considered a success given the presented results.

\vspace{0.05\textheight}

Keywords: BeagleBone, Black, Node.js, controller, brewing, beer, automated, SBC, web, internet, remote.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% INSER??O P?GINA EM BRANCO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\cleardoublepage
%\thispagestyle{empty}
%\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% RESUMO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% CONFIGURA??ES DOS ?NDICES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\clearpage
%\thispagestyle{empty}
\listoffigures % ?ndice de Figuras

\listoftables % ?ndice de Tabelas

\lstlistoflistings % indice de codigos
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% INSER??O P?GINA EM BRANCO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LISTA DE ABREVIATURAS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{./Content/pretexto/siglas.tex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% CONFIGURAÇÕES DOS ÍNDICES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{} % clear all header and footer fields
\fancyhead[RO, LE] {\thepage}

\fancypagestyle{plain}{\pagestyle{fancy}}

\tableofcontents % Índice Geral
